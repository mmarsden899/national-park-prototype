(window["webpackJsonpnational-parks-prototype"]=window["webpackJsonpnational-parks-prototype"]||[]).push([[0],{37:function(e,t,a){e.exports=a(76)},42:function(e,t,a){},44:function(e,t,a){},45:function(e,t,a){},46:function(e,t,a){},76:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(32),i=a.n(s),c=(a(42),a(2)),o=a.n(c),l=a(6),u=a(4),m=a(5),p=a(8),d=a(7),h=a(9),f=(a(44),a(45),a(46),a(15)),k=a(13),v=a.n(k),b="https://national-parks-mm.herokuapp.com",g="http://localhost:4741",E="localhost"===window.location.hostname?g:b,N=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(p.a)(this,Object(d.a)(t).call(this,e))).state={park:{}},a}return Object(h.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){var e=Object(l.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v()("".concat(E,"/parks/").concat(this.props.target));case 2:t=e.sent,this.setState({park:t.data.park});case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state.park;return r.a.createElement("div",{className:"park-modal"},r.a.createElement("div",{className:"single-park-flex"},r.a.createElement("div",{className:"park-image-container"},r.a.createElement("img",{src:e.image,alt:"temp",className:"modal-image"})),r.a.createElement("div",{className:"park-info"},r.a.createElement("h3",{className:"modal-header"},e.name),r.a.createElement("h6",{className:"modal-sub-header"},r.a.createElement("i",null,e.location)),r.a.createElement("div",{className:"modal-resp"},r.a.createElement("p",{className:"info thirty-padding-top est"},r.a.createElement("b",null,"Established: "),e.established),r.a.createElement("p",{className:"info area"},r.a.createElement("b",null,"Area: "),e.area),r.a.createElement("p",{className:"info vis"},r.a.createElement("b",null,"Total Visitors: "),e.rec_visitors)),r.a.createElement("p",{className:"modal-park-desc"},e.description))))}}]),t}(n.Component),y=a(33),O=a(16),S=a.n(O),j=S()({basename:"/todomvc-authorization-client"}),w=function(){function e(){var t=this;Object(u.a)(this,e),this.requestedScopes="openid profile",this.auth0=new y.a.WebAuth({domain:"dev-0r9j-iz3.auth0.com",audience:"https://dev-0r9j-iz3.auth0.com/userinfo",clientID:"1HbLQ6nRcscQnN2UY5i79et3CRBQq3zQ",redirectUri:"https://mmarsden89.github.io/national-park-prototype/callback",responseType:"id_token",scope:this.requestedScopes}),this.handleAuthentication=function(){t.auth0.parseHash((function(e,a){console.log(a),a&&a.accessToken&&a.idToken?(t.setSession(a),j.replace("/")):e&&(j.replace("/"),console.log(e))}))},this.isAuthenticated=function(){var e=JSON.parse(localStorage.getItem("expires_at"));return(new Date).getTime()<e}}return Object(m.a)(e,[{key:"getProfile",value:function(){return this.profile}},{key:"getIdToken",value:function(){return this.idToken}},{key:"isAuthenticated",value:function(){return(new Date).getTime()<this.expiresAt}},{key:"signIn",value:function(){this.auth0.authorize()}},{key:"setSession",value:function(e){this.idToken=e.idToken,this.profile=e.idTokenPayload;var t=1e3*e.idTokenPayload.exp,a=e.scope||this.requestedScopes||"";localStorage.setItem("access_token",e.accessToken),localStorage.setItem("id_token",e.idToken),localStorage.setItem("expires_at",t),localStorage.setItem("name",e.idTokenPayload.nickname),localStorage.setItem("avatar",e.idTokenPayload.picture),localStorage.setItem("scopes",JSON.stringify(a)),localStorage.setItem("email",e.idTokenPayload.email),j.replace("/")}},{key:"signOut",value:function(){this.auth0.logout({returnTo:"https://mmarsden89.github.io/national-park-prototype/callback",clientID:"1HbLQ6nRcscQnN2UY5i79et3CRBQq3zQ"}),localStorage.removeItem("access_token"),localStorage.removeItem("id_token"),localStorage.removeItem("expires_at"),localStorage.removeItem("name"),localStorage.removeItem("avatar"),localStorage.removeItem("scopes"),localStorage.removeItem("email"),j.replace("/")}},{key:"silentAuth",value:function(){var e=this;return new Promise((function(t,a){e.auth0.checkSession({},(function(n,r){if(n)return a(n);e.setSession(r),t()}))}))}},{key:"getAccessToken",value:function(){var e=localStorage.getItem("access_token");if(!e)throw new Error("No access token found");return e}},{key:"userHasScopes",value:function(e){var t=JSON.parse(localStorage.getItem("scopes"));if(!t)return!1;var a=t.split(" ");return e.every((function(e){return a.includes(e)}))}},{key:"getUserEmail",value:function(){return localStorage.getItem("email")}}]),e}(),I=a(10),T=a(11),x=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(p.a)(this,Object(d.a)(t).call(this,e))).openModal=function(e){a.setState({modal:!a.state.modal,selectedTarget:e.currentTarget.id})},a.closeModal=function(){a.state.modal&&a.setState({modal:!1})},a.handleVisit=function(){var e=Object(l.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.target.id,e.next=3,v()({url:E+"/Users/".concat(a.state.user.nickname),method:"PATCH",data:{user:{list:n}}});case 3:a.getUser();case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.visited=function(){var e=a.state.parks.filter((function(e){return a.state.user.list.includes(e._id)}));a.setState({filter:e})},a.notVisited=function(){var e=a.state.parks.filter((function(e){return!a.state.user.list.includes(e._id)}));a.setState({filter:e})},a.all=function(){a.setState({filter:a.state.parks})},a.state={parks:[],filter:[],modal:!1,selectedTarget:"",user:{list:[]}},a.getUser=a.getUser.bind(Object(f.a)(a)),a}return Object(h.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){var e=Object(l.a)(o.a.mark((function e(){var t,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v()("".concat(E,"/parks"));case 2:t=e.sent,this.setState({parks:t.data.parks,filter:t.data.parks}),a={list:[]},this.setState({user:a}),this.getUser();case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getUser",value:function(){var e=Object(l.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!w.isAuthenticated()){e.next=8;break}return clearInterval(window.interval),e.next=4,v()("".concat(E,"/users/").concat(w.getProfile().nickname));case 4:(t=e.sent).data.User.length<1?this.createUser().then(this.getUser):this.setState({user:t.data.User[0]}),e.next=9;break;case 8:window.interval=setInterval(this.getUser,1e3);case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"createUser",value:function(){var e=Object(l.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v()({url:E+"/users",method:"POST",data:{user:{nickname:w.getProfile().nickname}}});case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.state.filter,a=this.state.user.list,n=r.a.createElement("div",{className:"filler"}),s=r.a.createElement("div",{className:"filter-buttons-div"},r.a.createElement("button",{onClick:this.all,className:"filter-buttons"},"All"),r.a.createElement("button",{onClick:this.visited,className:"filter-buttons"},"Visted"),r.a.createElement("button",{onClick:this.notVisited,className:"filter-buttons"},"Not-Visited")),i=t.map((function(t){return r.a.createElement("div",{key:t._id,id:t._id,className:"parks"},w.isAuthenticated()?a.includes(t._id)?r.a.createElement(I.a,{icon:T.b,onClick:e.handleVisit,id:t._id,className:"plusOrMinus"}):r.a.createElement(I.a,{icon:T.c,onClick:e.handleVisit,id:t._id,className:"plusOrMinus"}):null,r.a.createElement("div",{className:"park-container",onClick:e.openModal,id:t._id},r.a.createElement("img",{src:t.thumbnail,alt:"thumbnail of "+t.name,className:"park-thumbnail"}),r.a.createElement("div",{className:"info-grid"},r.a.createElement("p",{className:"park-name"},t.name," National Park"),r.a.createElement("p",{className:"info"}," ",r.a.createElement("b",null,"Location:")," ",t.location," ",r.a.createElement("b",null,"Founded:")," ",t.established),r.a.createElement("p",{className:"info"}," ",r.a.createElement("b",null,"Total Area:")," ",t.area," ",r.a.createElement("b",null,"Total Visitors:")," ",t.rec_visitors),r.a.createElement("p",{className:"info desc"},t.description))))}));return r.a.createElement("div",{className:"container",onClick:this.closeModal},w.isAuthenticated()?s:n,i,this.state.modal?r.a.createElement(N,{target:this.state.selectedTarget}):null)}}]),t}(n.Component),A=a(77),_=a(78),U=function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"header-app"},r.a.createElement("img",{src:"https://img.pngio.com/forest-silhouette-png-101-images-in-collection-page-2-forest-silhouette-png-1400_471.png",alt:"",className:"image-header"}),r.a.createElement("h1",{className:"logo-text"},"NATIONAL PARKS"))}}]),t}(n.Component);var C=Object(_.a)((function(e){return r.a.createElement("nav",{className:"navbar"},r.a.createElement("div",{className:"navbar-container"},!w.isAuthenticated()&&r.a.createElement(I.a,{icon:T.d,className:"signout",onClick:w.signIn}),w.isAuthenticated()&&r.a.createElement("div",{className:"profile-area"},r.a.createElement("label",{className:"nickname"},w.getProfile().nickname),r.a.createElement(I.a,{icon:T.e,onClick:function(){w.signOut(),e.history.replace("/")},className:"signout"}))),r.a.createElement("div",{className:"gradient"}))})),P=function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){var e=Object(l.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w.handleAuthentication();case 2:this.props.history.replace("/");case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return r.a.createElement("div",{className:"callback-load"},r.a.createElement("p",null,"Loading profile..."))}}]),t}(n.Component),M=Object(_.a)(P),D=a(36),V=a.n(D);var Q=function(){return r.a.createElement(V.a,{showUnder:160,duration:1500,easing:"easeInOutCubic",style:{transitionDuration:"1s"}},r.a.createElement(I.a,{icon:T.a,className:"scrollUp"}))},z=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(p.a)(this,Object(d.a)(t).call(this,e))).state={checkingSession:!0},a}return Object(h.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){var e=Object(l.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("/callback"!==this.props.location.pathname){e.next=3;break}return this.setState({checkingSession:!1}),e.abrupt("return");case 3:return e.prev=3,e.next=6,w.silentAuth();case 6:this.forceUpdate(),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(3),"login_required"!==e.t0.error&&console.log(e.t0);case 12:this.setState({checkingSession:!1});case 13:case"end":return e.stop()}}),e,this,[[3,9]])})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return r.a.createElement("div",{className:"App"},r.a.createElement(C,null),r.a.createElement(Q,null),r.a.createElement("div",{className:"App-body"},r.a.createElement(U,null),r.a.createElement(x,null),r.a.createElement(A.a,{path:"/callback",render:function(e){return w.handleAuthentication(e),r.a.createElement(M,e)}})))}}]),t}(n.Component),q=Object(_.a)(z),H=a(79),J=S()({basename:"/todomvc-authorization-client"}),L=r.a.createElement(H.a,{history:J},r.a.createElement(q,null));i.a.render(L,document.getElementById("root"))}},[[37,1,2]]]);
//# sourceMappingURL=main.a350d3d0.chunk.js.map